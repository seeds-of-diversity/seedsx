/*!
 * Taquin JavaScript Library v1.2.3
 * http://www.taquin.net
 *
 * Copyright (c) 2013, Matthieu Benéteau
 * All rights reserved
 * http://matthieubeneteau.com
 *
 * Date: Mar  5 fév 2013 20:30:44 CET
 */
(function(b){function L(){if(!y)return!1;M();for(var a in o.init)o.init[a]()}function F(a,c){var d="",e="";a?(d=/(_std|_notxt)/i,e="_noimg"):c?(d=/(_std|_noimg)/i,e="_notxt"):(d=/(_noimg|_notxt)/i,e="_std");b(".tPage a").each(function(){this.href=this.href.replace(d,e)});a?b("#randomLink").addClass("tInactive"):b("#randomLink").removeClass("tInactive")}function ga(){b(".tActive").click(function(){return!1});b(".tSite a, .tADynFile, .tCLang a:not(.tActive), .tCModes a:not(.tReplay)").click(N);b(".tPHelp .tImgZoom").mouseover(function(){b("#help_image").show()}).mouseout(function(){b("#help_image").hide()});
var a=function(a){b(".tMode:not(.tRandom)").removeClass("tActive");b(a).addClass("tActive")};b(".tAStd").click(function(c){F(0,0);a(this);b(".tPage").addClass("tStd").removeClass("tNoimg tNotxt");c.preventDefault()});b(".tANoimg").click(function(c){F(1,0);a(this);b(".tPage").addClass("tNoimg").removeClass("tStd tNotxt");c.preventDefault()});b(".tANotxt").click(function(c){F(0,1);a(this);b(".tPage").addClass("tNotxt").removeClass("tStd tNoimg");c.preventDefault()});b(".tSolve").click(function(a){O(a)});
b(".tStep").click(function(a){b(".tPage").addClass("tStepped").removeClass("tPaused");q?(r=!0,z()):O();a.preventDefault()});b(".tPause").click(function(a){b(".tPage").addClass("tPaused").removeClass("tStepped");r=!1;q=null;a.preventDefault()});b(".tNav a").click(function(){var a=this.rel;b(".tConsole").not(".tC"+a).hide();b(".tNav a").not(".tNav .tA"+a).removeClass("tActive");b(".tConsole.tC"+a).toggle();b(".tNav .tA"+a).toggleClass("tActive").hasClass("tActive")?P():Q();return!1})}function A(){b(i+
" .tElt").css("cursor","default").find("a").hide();for(var a=0,c=0,d=1;d<=h;d++)if(j.hasClass("tRow"+d)){a=d;break}a&&b(i+" .tRow"+a+" .tElt").css("cursor","pointer");for(a=1;a<=g;a++)if(j.hasClass("tCol"+a)){c=a;break}c&&b(i+" .tCol"+c+" .tElt").css("cursor","pointer")}function ha(){b(i+" .tPawn:not(.tHole) .tElt").click(ia);b("#board, #quote").click(function(){b(".tPage.tSolved:not(.tFile) #h_replayLink")[0].click()});b(".tPage.tTouch .tBoard .tElt").each(function(){var a=b(this),c=a.data("events");
if(!c)return!1;var d=!1;b.each(c,function(c,f){c=="click"&&(b.each(f,function(c,b){a.bind("touchend",b.handler)}),d=!0)});d&&a.unbind("click")})}function ja(){b(document).keydown(function(a){if(a.keyCode>=37&&a.keyCode<=40&&G()){for(var c=0,d=0,e=1;e<=h;e++)j.hasClass("tRow"+e)&&(c=e);for(e=1;e<=g;e++)j.hasClass("tCol"+e)&&(d=e);if(c*d!=0){dir=(std=!0,1);switch(a.keyCode){case 37:H(b(i+" .tRow"+c+".tCol"+(d+dir)),c);break;case 38:I(b(i+" .tRow"+(c+dir)+".tCol"+d),d);break;case 39:H(b(i+" .tRow"+c+
".tCol"+(d-dir)),c);break;case 40:I(b(i+" .tRow"+(c-dir)+".tCol"+d),d)}a.preventDefault()}}a.keyCode==27&&b(".tPage").hasClass("tDynFiles")&&R()})}function ka(){if(!b(".tPage").hasClass("tDynReplay"))return!1;S();b("#replayLink, #h_replayLink").click(function(){la();return!1});b("#replayLink").addClass("tActive")}function ma(){if(!b(".tPage").hasClass("tDynFiles"))return!1;b(".tADynFile").click(T);b(".tADynBack").click(function(){R();B="";return!1})}function M(){b(".tDoc").first().each(function(){if(b(this).attr("id")!=
"t_doc_wrapper"){var a='<div id="t_doc_scroller">'+b(this).html()+"</div>";b(this).attr("id","t_doc_wrapper").html(a);b(this).scroll(function(){var a=b(this);a.scrollTop()==0?a.addClass("tDocTop"):a.removeClass("tDocTop");var d=a.children("#t_doc_scroller").first(),e=a.innerHeight()+a.offset().top-d.offset().top,d=d.outerHeight();e>=d&&e<5E3?a.addClass("tDocBot"):a.removeClass("tDocBot")})}});b(".tDoc").scroll()}function N(){if(b(this).hasClass("tInactive"))return!1;var a;var c=this.href;a=b(this).parent().hasClass("tCLang");
if(!b(".tPage").hasClass("tLocal")){c=C(c,U);c=C(c,V);c=D(c,"s",W());if(k&&(G()||s)){var d=k;s&&(d+=(new Date).getTime()-n);c=D(c,"t",d)}a&&B&&(c=c.replace(/\/[a-zA-Z]+_/i,"/"+B+"_"))}a=c;this.href=a;return!0}function T(){na(this.href.replace(".html",".ihtm"),this);B=b(this).attr("rel");b(this).addClass("tActive");return!1}function ia(){if(!G())return!1;for(var a=b(this).parent().first(),c="",c="",d=1;d<=h;d++)if(c="tRow"+d,j.hasClass(c)&&a.hasClass(c))return H(a,d);for(d=1;d<=g;d++)if(c="tCol"+d,
j.hasClass(c)&&a.hasClass(c))return I(a,d);return!1}function X(){k=(new Date).getTime();m=n=0;w();b(".tPage").addClass("tStartedOnce")}function w(){if(!p)return!1;var a=m?m:(new Date).getTime(),a=new Date(a-k),c=k&&a.getTime()>=Y;!m&&c&&(a=new Date(Y));var b=a.getMinutes(),e=a.getSeconds(),b=(b<10?"0":"")+b+"&prime;",e=(e<10?"0":"")+e+"&Prime;";p.html(b+e);!m&&!c?n||setTimeout(w,Z):(a=a.getMilliseconds(),p.html(b+e+((a<100?"0":"")+(a<10?"0":"")+a)))}function P(){s++;if(s>1)return!1;n=(new Date).getTime()}
function Q(){s--;if(s>0)return!1;if(m||!n)return!1;if(k){var a=(new Date).getTime();k+=a-n;setTimeout(w,Z)}n=0}function $(a){m=n=k=0;p.html("00&prime;00&Prime;");now=(new Date).getTime();a>0&&a<now&&(k=a,w(),b(".tPage").addClass("tStartedOnce"))}function G(){if(m||n||r)return!1;return!0}function H(a,c){for(var d=0,e=0,f=1;f<=g;f++)col="tCol"+f,j.hasClass(col)&&(d=f),a.hasClass(col)&&(e=f);if(d*e==0)return!1;var l=b(i+" .tRow"+c);if(d>e)for(f=d-1;f>=e;f--)l.filter(".tCol"+f).addClass("tColTmp"+(f+
1)).removeClass("tCol"+f);else for(f=d+1;f<=e;f++)l.filter(".tCol"+f).addClass("tColTmp"+(f-1)).removeClass("tCol"+f);l.filter(".tCol"+d).addClass("tColTmp"+e).removeClass("tCol"+d);for(f=1;f<=g;f++)l.filter(".tColTmp"+f).addClass("tCol"+f).removeClass("tColTmp"+f);A();k||X();E();return!1}function I(a,c){for(var d=0,e=0,f=1;f<=h;f++)row="tRow"+f,j.hasClass(row)&&(d=f),a.hasClass(row)&&(e=f);if(d*e==0)return!1;var l=b(i+" .tCol"+c);if(d>e)for(f=d-1;f>=e;f--)l.filter(".tRow"+f).addClass("tRowTmp"+(f+
1)).removeClass("tRow"+f);else for(f=d+1;f<=e;f++)l.filter(".tRow"+f).addClass("tRowTmp"+(f-1)).removeClass("tRow"+f);l.filter(".tRow"+d).addClass("tRowTmp"+e).removeClass("tRow"+d);for(f=1;f<=h;f++)l.filter(".tRowTmp"+f).addClass("tRow"+f).removeClass("tRowTmp"+f);A();k||X();E();return!1}function S(){for(var a=[],c=1;c<=t;c++)a[c]=c;for(var c=4*t*t,d=1;d<=c;d++){var e=1+Math.floor(Math.random()*(t-2)),f=a[e];a[e]=a[e+1];a[e+1]=f}d=c="";for(e=1;e<=h;e++)c+=" tRow"+e;for(f=1;f<=g;f++)d+=" tCol"+f;
for(e=1;e<=h;e++)for(f=1;f<=g;f++)elt=a[(e-1)*g+f],c_div="tRow"+e+" tCol"+f,c_lnk="tE"+elt,b("."+c_lnk).parent().removeClass(c).removeClass(d).addClass(c_div)}function E(){for(var a="",c=!0,d=1;d<=h;d++){for(var e=1;e<=g;e++)if(a=".tRow"+d+".tCol"+e+" .tE"+((d-1)*g+e),!b(a).length){c=!1;break}if(!c)break}c&&oa()}function oa(){p&&!k&&p.hide();m=(new Date).getTime();b(".tPage.tAnimated").each(function(){var a=b(i);j.show();a.find(".tDimmer").fadeOut(300,"linear",function(){a.find(".tPawn").fadeOut(300,
"linear",function(){});j.hide();b(".tPage.tAnimated").addClass("tSolved");b("#replayLink, #h_replayLink").first().focus()});b(".tCopy").animate({opacity:1},900)});b(".tPage:not(.tAnimated)").addClass("tSolved");b("#replayLink").removeClass("tActive");b("#replayLink, #h_replayLink").first().focus()}function la(){S();$(0);A();b(".tPage.tAnimated").each(function(){b(".tPawn, .tDimmer").show();j.hide();b(".tCopy").css("opacity","0.25")});b("#replayLink").blur().addClass("tActive");b(".tPage").removeClass("tSolved")}
function na(a,c){J||P();b(".tPage").addClass("tFile");if(b(".tPage").hasClass("tNoCache"))var d=(new Date).getTime(),a=D(a,"time",d);d=b(".tIncFile");d.html(aa);d.load(a,function(a,b,d){pa(a,b,d,c)})}function pa(a,c,d,e){if(c!="error"){b(".tIncFile .tDoc").focus();if(e.title)u=!u?document.title:u,document.title=e.title;b(".tIncFile").find(".tADynFile, .tAImage").click(N);b(".tIncFile").find(".tADynFile").click(T);b(".tIncFile .tDoc a[href^=#]").each(function(){var a=window.location.href,b=a.indexOf("#"),
c=this.href.indexOf("#"),a=b>1?a.substr(0,b):a;this.href=a+this.href.substr(c)});M();for(var f in o.load)o.load[f]();J=!0}else window.location.replace(e.href)}function R(){b(".tPage").removeClass("tFile");b(".tADynFile").removeClass("tActive");b(".tIncFile").html("");if(u)document.title=u,u="";for(var a in o.unload)o.unload[a]();J=!1;Q()}function O(a){b(".tPage").addClass("tStepped").removeClass("tPaused");b("#timer").remove();p=null;m=0;var c=b(".tSolve").first().attr("action"),c=c.replace(".html",
".json"),c=C(c,U),c=C(c,V),c=D(c,"s",W());b.getJSON(c,qa);a.preventDefault()}function qa(a){q=a;r=!0;z()}function z(){if(!r)return!1;if(!q||!q.length)q=null,r=!1,E();else{var a=q.shift();s_len=h*g>x?2*h*g-x:h*g;if(a&&a.length==s_len){b(".tPawn").attr("class","tPawn");j.addClass("tHole");for(var a=a.toLowerCase(),c=0,d=0,e=0,f=1;f<=h;f++)for(var l=1;l<=g;l++)c=(f-1)*g+l,d=ba(a.charAt(c+e-1)),d>x&&(d=(d-x)*x+ba(a.charAt(c+e)),e++),b(".tPawn").has(".tElt.tE"+d).addClass("tRow"+f+" tCol"+l)}setTimeout(z,
Math.floor(ra/h))}return!0}function ba(a){var b=0,a=a.charCodeAt(0);a>=49&&a<=57?b=a-48:a>=97&&a<=122?b=a-87:a==45?b=36:a==46?b=37:a==126&&(b=38);return b}function K(a){var b="";a>=1&&a<=9?b=v(a+48):a>=10&&a<=35?b=v(a+87):a==36?b=v(45):a>36&&a<=72?b="."+K(a-36):a>72&&a<=108&&(b="~"+K(a-72));return b}function W(){for(var a="",c=1;c<=h;c++)for(var d=1;d<=g;d++)b(".tPawns .tPawn.tRow"+c+".tCol"+d).children(".tElt").each(function(){for(var c=1;c<=t;c++)if(b(this).hasClass("tE"+c)){a+=K(c);break}});return a}
function D(a,b,d){var e=a.indexOf("?");e<0?a+="?":e<a.length-1&&(a+="&");a+=b+"="+encodeURI(d);return a}function C(a,b){var d=a.replace(b,""),d=d.replace("?&","?");return d=d.replace("&&","&")}function sa(){b(".tQuote.tEnc").find(".tQ, .tA").each(function(){this.innerHTML=ca(this.innerHTML)}).filter(".tQ").each(function(){this.innerHTML="&#171;&nbsp;"+this.innerHTML+"&nbsp;&#187;"});b(".tQuote").addClass("tDec");b("#quote_ie .tQ").html(b("#quote .tQ").html());b("#quote_ie .tA").html(b("#quote .tA").html())}
function ta(){b(".tLocal .tZStamp").find(".tZAuthor, .tZDate").each(function(){this.innerHTML=ca(this.innerHTML)})}function ca(a){for(var b="",d,e,f,g,h,i=2,j=function(a){return ua.indexOf(a)},k=function(b){return a.charAt(b)};i<a.length;)d=j(k(i++)),e=j(k(i++)),g=j(k(i++)),h=j(k(i++)),d=d<<2|e>>4,e=(e&15)<<4|g>>2,f=(g&3)<<6|h,b+=v(d),g!=64&&(b+=v(e)),h!=64&&(b+=v(f));return b}b.Taquin={init:function(a,c,d,e){if(y)return!1;b("body").addClass("tScriptOn");if(b(".tPage").hasClass("tFile"))return y=
!0,L(),!1;h=Math.min(da,Math.max(ea,a));g=Math.min(da,Math.max(ea,c));t=h*g;p=b("#timer");i="#board.tB"+h+"x"+g;j=b(i+" .tHole:first");fa=d;aa='<div class="tLoader"><img src="'+fa+'img/loader.gif" /></div>';$(e);ga();A();ha();ja();ka();ma();sa();ta();b(".tPage").addClass("tDynamic tAnimated").removeClass("tStatic");E();y=!0;L()},pace:w,step:z,extend:function(a,b){o[a]&&o[a].push(b)}};var ea=3,da=10,x=36,Y=3599999,Z=200,ra=3E3,ua="sK8nbVaR+lECfMLSTj30eIYw4FBtAoOHyhcGkdgiQxZr56D/qvUW79JXz2P1muNp=",
U=/s=[0-9a-z\-\.~]*/i,V=/t=[0-9]*/,y=!1,h=3,g=3,t=h*g,i="",j=null,p=null,k=0,n=0,m=0,s=0,fa="",aa="",B="",u="",q=null,r=!1,J=!1,o={init:[],load:[],unload:[],solve:[]},v=String.fromCharCode})(jQuery);
